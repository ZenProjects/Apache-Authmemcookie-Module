version: 2
jobs:
    build-debian-latest:
      docker:
        - image: debian:latest
      steps:
        - checkout
        - run:
            name: pre 
            command: apt-get update && apt-get install -y gcc apache2-dev memcached libmemcached-dev autoconf
        - run:
            name: libmemcached version
            command: dpkg -s libmemcached-dev && dpkg -L libmemcached-dev
        - run:
            name: autogen
            command: autoconf -f
        - run:
            name: autoconf
            command: ./configure --with-apxs=/usr/bin/apxs --with-libmemcached=/usr && cat mod_auth_memcookie.h || cat config.log  
        - run:
            name: build
            command: make  && ls -al .libs/mod_auth_memcookie.so
    build-ubuntu-14:
      docker:
        - image: ubuntu:14.04
      steps:
        - checkout
        - run:
            name: pre 
            command: apt-get update && apt-get install -y gcc apache2-dev memcached libmemcached-dev autoconf
        - run:
            name: libmemcached version
            command: dpkg -s libmemcached-dev && dpkg -L libmemcached-dev
        - run:
            name: autogen
            command: autoconf -f
        - run:
            name: autoconf
            command: ./configure --with-apxs=/usr/bin/apxs --with-libmemcached=/usr && cat mod_auth_memcookie.h || cat config.log  
        - run:
            name: build
            command: make  && ls -al .libs/mod_auth_memcookie.so
 
workflows:
  version: 2
  multiple_os_build:
    jobs:
      - build-debian-latest
      - build-ubuntu-14
